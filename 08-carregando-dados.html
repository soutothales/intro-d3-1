<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="utf-8">
  <title>Barras simples</title>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
</head>

<body>
  <div class="container">
    <div class="row">
      <h2>Barras com dados findos de uma url</h2>
    </div>
    <div class="row mychart" id="chart">
    </div>
  </div>

  <style>
    .mychart rect {
      fill: steelblue;
    }

    .mychart rect:hover {
      fill: goldenrod;
    }

    .mychart text {
      font: 12px sans-serif;
      text-anchor: left;
    }
  </style>

  <script type="text/javascript">
    "use strict"

    function desenhaBarras(dados) {
          var svg = d3.select('#group')
                    .append('svg')
                    .attr('width', 750)
                    .attr('height', 500);

          var group1 = svg.selectAll("g")
                      .data(dados)
                      .enter()
                      .append("g");


          group1.append('rect')
                             .attr('x', 0)
                             .attr('y', function(d, i){return i * 30})
                             .attr('width', function(d) {
                                return d.valor*3;
                             })
                             .attr('height', 20);

          group1.append('text')
                  .text(function(d){
                     return d;
                  })
                  .attr("x", function(d) {return (d.valor*3) - 17;})
                  .attr("y", function(d, i){return (i * 30) + 15});
    }

    d3.tsv('dados/alphabet.tsv', function(dados) {
      console.log("provavelmente acontece depois")
      desenhaBarras(dados);
    });

    console.log("provavelmente acontece primeiro") // me apague quando entender.

    /*
    * Assim como a função d3.tsv, existe a d3.csv e a d3.json
    * Em todas, o primeiro parâmetro é uma URL e o segundo a função que
    * será executada quando o dado for obtido.
    * >>>>> A chamada ao d3.tsv é assíncrona <<<<<<
    */
  </script>
</body>

</html>
